<%- include("partials/headerFooter/header.ejs") -%>
    

<h1>Exercises</h1>

<br>

<%#LOOP FOR OVER ALL EXERCISE%>
<%exercises.forEach(function(exercise, index){%>

<%#CHANGE UNIT FOR SELECT EXERCISES%>
<% let unit = "reps" %>  
<% if (exercise.name === "Plank Hold" | exercise.name === "Side Plank Hold" | exercise.name === "Hip Bridge Hold") {unit = "seconds"}%>

<div class="card">
<div class="card-body">

<div id="E<%=index%>">
<h2 class="card-title"><%= exercise.name %> </h2>

<p class="text-muted inline-block"><a href="#" data-toggle="modal" data-target="#instructionsModal<%=index%>">Instructions</a></p> | 
<p class="text-muted inline-block"><a href="#" class="viewPast" data-exercise="<%=index%>" data-toggle="modal" data-target="#pastExercisesModal<%=index%>">History</a></p>


    <!-- Instructions Modal -->
    <%- include("partials/workout/instructionsModal.ejs", {index: index, exercise: exercise}) -%>

    <!-- History Modal -->
    <%- include("partials/workout/historyModal.ejs", {index: index, exercise: exercise}) -%>

    <!-- Hande if first time on exercise -->
    <%if (lastExercises[index].sets[0].reps === null && exercise.name != "Plank Hold" && exercise.name != "Side Plank Hold" && exercise.name != "Hip Bridge Hold"){ %>
    
    <%- include("partials/workout/firstTimeExercise.ejs", {index: index, exercise: exercise, unit: unit}) -%>

    <!-- Hande if not first time on exercise -->
    <%} else { %>

    <!-- Warmups -->
    <%- include("partials/workout/warmups.ejs", {index: index, exercise: exercise}) -%>


    <!-- Sets -->   
    <form action="/workout/<%=packageUrl%>/<%=workout.nameShort%>" method="POST">
    
    <%exercise.sets.forEach(function(set, i){%>
        <h4>Set <%=i + 1%></h4>
        <% const weight = displayExercises[index][i].weight %>

        <!-- Last Week -->   
        <%- include("partials/workout/lastWeek.ejs", {index: index, exercise: exercise, unit: unit, i:i, weight: weight}) -%>
    
        <!-- Bar Calculator -->   
        <%- include("partials/workout/barCalc.ejs", {index: index, exercise: exercise, unit: unit, i:i, weight: weight}) -%>
            
        <!-- Reps -->   
        <%- include("partials/workout/reps.ejs", {index: index, exercise: exercise, unit: unit, i:i, weight: weight}) -%>
                
        <br>

        <!-- Weights -->   
        <%- include("partials/workout/weights.ejs", {index: index, exercise: exercise, unit: unit, i:i, weight: weight}) -%>
            
        <!-- Notes -->   
        <%- include("partials/workout/notes.ejs", {index: index, exercise: exercise, unit: unit, i:i, weight: weight}) -%>

    <%})%>
    <input type="hidden" name="isFirstTime" value="false">
    <input type="hidden" name="exerciseName" value="<%= exercise.name %>">
    <input data-exercise="<%=index%>" type="hidden" name="templateId" value="<%= exercise._id %>">
    <input type="hidden" name="packageUrl" value="<%= packageUrl %>">
    <input type="hidden" name="workout" value="<%= workout.nameShort %>">
    <input type="hidden" name="order" value="<%= exercise.order %>">
    <button type="submit" class="btn btn-primary workout-button">Save</button>
    </form>

    <%}%>

    </div>

    </div>
</div>

<%})%>

</div>


<%- include("partials/headerFooter/footer.ejs") -%>